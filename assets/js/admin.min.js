jQuery(function(e){function t(){s.find(".mas_wcvs-term-name input, .mas_wcvs-term-slug input").val(""),i.removeClass("is-active"),c.removeClass("error success").hide(),s.hide()}e("#mas_wcvs_image_id").val()||e(".mas_wcvs_remove_image_button").hide();var a;e(document).on("click",".mas_wcvs_upload_image_button",function(t){t.preventDefault(),a?a.open():((a=wp.media.frames.downloadable_file=wp.media({title:mas_wcvs_admin_options.media_title,button:{text:mas_wcvs_admin_options.media_btn_text},multiple:!1})).on("select",function(){attachment=a.state().get("selection").first().toJSON(),e("#mas_wcvs_image_id").val(attachment.id),e("#mas_wcvs_image img").attr("src",attachment.url),e(".mas_wcvs_remove_image_button").show()}),a.open())}),e(document).on("click",".mas_wcvs_remove_image_button",function(t){return e("#mas_wcvs_image img").attr("src",mas_wcvs_admin_options.placeholder_img_src),e("#mas_wcvs_image_id").val(""),e(".mas_wcvs_remove_image_button").hide(),!1}),e(".mas_wcvs_color_picker").wpColorPicker();var s=e("#mas_wcvs-modal-container"),i=s.find(".spinner"),c=s.find(".message"),m=null;e(document).on("click",".mas_wcvs_add_new_attribute",function(t){t.preventDefault();var a=e(this),i=wp.template("mas_wcvs-input-tax"),c={type:a.data("type"),tax:a.closest(".woocommerce_attribute").data("taxonomy")};s.find(".mas_wcvs-term-swatch").html(e("#tmpl-mas_wcvs-input-"+c.type).html()),s.find(".mas_wcvs-term-tax").html(i(c)),"color"===c.type&&s.find("input.mas_wcvs-input-color").wpColorPicker(),m=a.closest(".woocommerce_attribute.wc-metabox"),s.show()}).on("click",".mas_wcvs-modal-close, .mas_wcvs-modal-backdrop",function(e){e.preventDefault(),t()}),e(document).on("click",".mas_wcvs-new-attribute-submit",function(a){a.preventDefault();e(this).data("type");var n=!1,o={};s.find(".mas_wcvs-input").each(function(){var t=e(this);"slug"===t.attr("name")||t.val()?t.removeClass("error"):(t.addClass("error"),n=!0),o[t.attr("name")]=t.val()}),n||(i.addClass("is-active"),c.hide(),wp.ajax.send("mas_wcvs_add_new_attribute",{data:o,error:function(e){i.removeClass("is-active"),c.addClass("error").text(e).show()},success:function(e){i.removeClass("is-active"),c.addClass("success").text(e.msg).show(),m.find("select.attribute_values").append('<option value="'+e.id+'" selected="selected">'+e.name+"</option>"),m.find("select.attribute_values").change(),t()}}))})});